import{u as e,s as t,j as r,a,b as s}from"./index-CAqKDf33.js";import{u as i,r as n,g as o}from"./vendor-DyLareeb.js";import{B as l}from"./Button-DSr7L9cc.js";import{I as d}from"./Input-Cis6Nnpo.js";import{H as c,a as h,C as x}from"./ProjectCarousel-Csmvfm6P.js";import"./ui-Dv3yRtCs.js";const m=()=>{const{user:a,signOut:s}=e(),o=i(),[d,c]=n.useState({heroImages:0,clientLogos:0,projects:0,inquiries:0,bookings:0});n.useEffect((()=>{h()}),[]);const h=async()=>{try{const{count:e}=await t.from("hero_images").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:r}=await t.from("client_logos").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:a}=await t.from("projects").select("*",{count:"exact",head:!0}).eq("is_active",!0),s=["corporate_event_inquiries","team_building_inquiries","csr_inquiries","training_program_inquiries"];let i=0;for(const o of s){const{count:e}=await t.from(o).select("*",{count:"exact",head:!0});i+=e||0}const{count:n}=await t.from("bookings").select("*",{count:"exact",head:!0});c({heroImages:e||0,clientLogos:r||0,projects:a||0,inquiries:i,bookings:n||0})}catch(e){}};return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Admin Dashboard"}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Welcome back, ",null==a?void 0:a.email]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(l,{onClick:()=>o("/"),className:"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-300 dark:hover:bg-gray-600",children:"View Site"}),r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})]})]})})}),r.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Hero Images"}),r.jsx("span",{className:"text-2xl",children:"ðŸ–¼ï¸"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"Manage hero section background images and animations"}),r.jsx(l,{onClick:()=>o("/admin/hero-images"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white mt-auto",children:"Manage Hero Images"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Client Logos"}),r.jsx("span",{className:"text-2xl",children:"ðŸ¢"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"Add, edit, or remove client logos from the sphere gallery"}),r.jsx(l,{onClick:()=>o("/admin/client-logos"),className:"w-full bg-purple-600 hover:bg-purple-700 text-white mt-auto",children:"Manage Client Logos"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Projects"}),r.jsx("span",{className:"text-2xl",children:"ðŸ’¼"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"Create and manage portfolio project showcase cards"}),r.jsx(l,{onClick:()=>o("/admin/projects"),className:"w-full bg-green-600 hover:bg-green-700 text-white mt-auto",children:"Manage Projects"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Inquiries"}),r.jsx("span",{className:"text-2xl",children:"ðŸ“¨"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"View and manage customer inquiries from all forms"}),r.jsx(l,{onClick:()=>o("/admin/inquiries"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white mt-auto",children:"View Inquiries"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Bookings"}),r.jsx("span",{className:"text-2xl",children:"ðŸ“…"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"Manage appointment bookings and schedules"}),r.jsx(l,{onClick:()=>o("/admin/bookings"),className:"w-full bg-teal-600 hover:bg-teal-700 text-white mt-auto",children:"View Bookings"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Media Library"}),r.jsx("span",{className:"text-2xl",children:"ðŸ“"})]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 flex-1",children:"Browse and manage all uploaded media files"}),r.jsx(l,{className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white mt-auto",children:"Open Media Library"})]})]}),r.jsxs("div",{className:"mt-8 bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-200 dark:border-gray-700",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Stats"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:d.heroImages}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Hero Images"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:d.clientLogos}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Client Logos"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:d.projects}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Projects"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:d.inquiries}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Inquiries"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-teal-600 dark:text-teal-400",children:d.bookings}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Bookings"})]})]})]})]})]})},g=()=>{const[t,a]=n.useState(""),[s,o]=n.useState(""),[c,h]=n.useState(""),[x,m]=n.useState(!1),{signIn:g,user:u,isAdmin:p,loading:y}=e(),b=i();n.useEffect((()=>{y||(u&&p?(m(!1),b("/admin/dashboard")):!u||p||x||(h("You do not have admin access"),m(!1)))}),[u,p,y,b,x]);return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 px-4",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Admin Login"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Sign in to access the content management system"})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-2xl rounded-2xl p-8",children:[r.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(""),m(!0);try{const{error:e}=await g(t,s);if(e)return h(e.message),void m(!1)}catch(r){h("An unexpected error occurred"),m(!1)}},className:"space-y-6",children:[c&&r.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg",children:c}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),r.jsx(d,{id:"email",type:"email",value:t,onChange:e=>a(e.target.value),placeholder:"admin@example.com",required:!0,className:"w-full"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),r.jsx(d,{id:"password",type:"password",value:s,onChange:e=>o(e.target.value),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,className:"w-full"})]}),r.jsx(l,{type:"submit",disabled:x,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:x?r.jsxs("span",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In"})]}),r.jsxs("div",{className:"mt-6 text-center space-y-3",children:[r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Don't have an account?"," ",r.jsx("button",{type:"button",onClick:()=>b("/admin/register"),className:"text-blue-600 dark:text-blue-400 hover:underline font-medium",children:"Create admin account"})]}),r.jsx("button",{onClick:()=>b("/"),className:"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"â† Back to Portfolio"})]})]}),r.jsx("p",{className:"text-center text-xs text-gray-500 dark:text-gray-400",children:"Protected by Supabase Authentication"})]})})};function u(){const e=i(),[a,s]=n.useState(""),[o,l]=n.useState(""),[d,c]=n.useState(""),[h,x]=n.useState(!1),[m,g]=n.useState(""),[u,p]=n.useState(!1);return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900 dark:from-black dark:via-neutral-950 dark:to-black p-4",children:r.jsxs("div",{className:"bg-white dark:bg-neutral-900 p-8 rounded-2xl shadow-2xl border border-neutral-200 dark:border-neutral-800 max-w-md w-full",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-3xl font-bold text-neutral-900 dark:text-white mb-2",children:"Create Admin Account"}),r.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 text-sm",children:"âš ï¸ One-time use only. Delete this page after registration."})]}),u?r.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[r.jsx("h3",{className:"text-green-800 dark:text-green-400 font-semibold mb-2",children:"âœ… Account Created!"}),r.jsx("p",{className:"text-green-700 dark:text-green-500 text-sm mb-3",children:"Your admin account has been created successfully."}),r.jsx("p",{className:"text-green-600 dark:text-green-600 text-xs",children:"Redirecting to login page..."})]}):r.jsxs("form",{onSubmit:async r=>{if(r.preventDefault(),g(""),o===d)if(o.length<6)g("Password must be at least 6 characters");else{x(!0);try{const{data:r,error:s}=await t.auth.signUp({email:a,password:o,options:{emailRedirectTo:`${window.location.origin}/admin/dashboard`,data:{email_confirm:!1}}});if(s)throw s;if(r.user){const{data:r,error:s}=await t.from("site_settings").select("setting_value").eq("setting_key","admin_emails").single();let i=[];if(!s&&(null==r?void 0:r.setting_value)&&(i=JSON.parse(r.setting_value)),!i.includes(a)){i.push(a);const{error:e}=await t.from("site_settings").upsert({setting_key:"admin_emails",setting_type:"admin",setting_value:JSON.stringify(i)},{onConflict:"setting_key"})}p(!0),setTimeout((()=>{e("/admin/login")}),3e3)}}catch(s){g(s.message||"Failed to create account")}finally{x(!1)}}else g("Passwords do not match")},className:"space-y-4",children:[m&&r.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:r.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:m})}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Email Address"}),r.jsx("input",{id:"email",type:"email",value:a,onChange:e=>s(e.target.value),required:!0,className:"w-full px-4 py-3 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-transparent transition-all",placeholder:"admin@example.com"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Password"}),r.jsx("input",{id:"password",type:"password",value:o,onChange:e=>l(e.target.value),required:!0,className:"w-full px-4 py-3 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-transparent transition-all",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),r.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-500 mt-1",children:"Minimum 6 characters"})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Confirm Password"}),r.jsx("input",{id:"confirmPassword",type:"password",value:d,onChange:e=>c(e.target.value),required:!0,className:"w-full px-4 py-3 rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600 focus:border-transparent transition-all",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),r.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl",children:h?"Creating Account...":"Create Admin Account"}),r.jsxs("div",{className:"text-center text-sm text-neutral-600 dark:text-neutral-400",children:["Already have an account?"," ",r.jsx("button",{type:"button",onClick:()=>e("/admin/login"),className:"text-blue-600 dark:text-blue-400 hover:underline font-medium",children:"Sign in"})]})]}),r.jsx("div",{className:"mt-6 pt-6 border-t border-neutral-200 dark:border-neutral-800",children:r.jsxs("p",{className:"text-xs text-neutral-500 dark:text-neutral-500",children:[r.jsx("strong",{children:"Security Note:"})," After creating your admin account, set"," ",r.jsx("code",{className:"bg-neutral-100 dark:bg-neutral-800 px-1 py-0.5 rounded",children:"ALLOW_REGISTRATION = false"})," ","in this file or delete it entirely."]})})]})})}var p,y,b,f,v,w,j,k,N,C,S,_,D,z,R,P=!1;function E(){if(!P){P=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),r=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(_=/\b(iPhone|iP[ao]d)/.exec(e),D=/\b(iP[ao]d)/.exec(e),C=/Android/i.exec(e),z=/FBAN\/\w+;/i.exec(e),R=/Mobile/i.exec(e),S=!!/Win64/.exec(e),t){(p=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(p=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(e);w=a?parseFloat(a[1])+4:p,y=t[2]?parseFloat(t[2]):NaN,b=t[3]?parseFloat(t[3]):NaN,(f=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),v=t&&t[1]?parseFloat(t[1]):NaN):v=NaN}else p=y=b=v=f=NaN;if(r){if(r[1]){var s=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);j=!s||parseFloat(s[1].replace("_","."))}else j=!1;k=!!r[2],N=!!r[3]}else j=k=N=!1}}var M,L={ie:function(){return E()||p},ieCompatibilityMode:function(){return E()||w>p},ie64:function(){return L.ie()&&S},firefox:function(){return E()||y},opera:function(){return E()||b},webkit:function(){return E()||f},safari:function(){return L.webkit()},chrome:function(){return E()||v},windows:function(){return E()||k},osx:function(){return E()||j},linux:function(){return E()||N},iphone:function(){return E()||_},mobile:function(){return E()||_||D||C||R},nativeApp:function(){return E()||z},android:function(){return E()||C},ipad:function(){return E()||D}},A=L,I={canUseDOM:!("undefined"==typeof window||!window.document||!window.document.createElement)};I.canUseDOM&&(M=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""))
/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */;var F=A,T=function(e,t){if(!I.canUseDOM||t&&!("addEventListener"in document))return!1;var r="on"+e,a=r in document;if(!a){var s=document.createElement("div");s.setAttribute(r,"return;"),a="function"==typeof s[r]}return!a&&M&&"wheel"===e&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a};function q(e){var t=0,r=0,a=0,s=0;return"detail"in e&&(r=e.detail),"wheelDelta"in e&&(r=-e.wheelDelta/120),"wheelDeltaY"in e&&(r=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=r,r=0),a=10*t,s=10*r,"deltaY"in e&&(s=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||s)&&e.deltaMode&&(1==e.deltaMode?(a*=40,s*=40):(a*=800,s*=800)),a&&!t&&(t=a<1?-1:1),s&&!r&&(r=s<1?-1:1),{spinX:t,spinY:r,pixelX:a,pixelY:s}}q.getEventType=function(){return F.firefox()?"DOMMouseScroll":T("wheel")?"wheel":"mousewheel"};const W=o(q);function U(e,t,r,a,s){void 0===s&&(s=0);var i=Y(t.width,t.height,s),n=i.width,o=i.height;return{x:O(e.x,n,r.width,a),y:O(e.y,o,r.height,a)}}function O(e,t,r,a){var s=t*a/2-r/2;return G(e,-s,s)}function B(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function $(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function Z(e,t){return Math.min(e,Math.max(0,t))}function V(e,t){return t}function H(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function Y(e,t,r){var a=r*Math.PI/180;return{width:Math.abs(Math.cos(a)*e)+Math.abs(Math.sin(a)*t),height:Math.abs(Math.sin(a)*e)+Math.abs(Math.cos(a)*t)}}function G(e,t,r){return Math.min(Math.max(e,t),r)}function X(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return"string"==typeof e&&e.length>0})).join(" ").trim()}var K=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.cropperRef=n.createRef(),r.imageRef=n.createRef(),r.videoRef=n.createRef(),r.containerPosition={x:0,y:0},r.containerRef=null,r.styleRef=null,r.containerRect=null,r.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},r.dragStartPosition={x:0,y:0},r.dragStartCrop={x:0,y:0},r.gestureZoomStart=0,r.gestureRotationStart=0,r.isTouching=!1,r.lastPinchDistance=0,r.lastPinchRotation=0,r.rafDragTimeout=null,r.rafPinchTimeout=null,r.wheelTimer=null,r.currentDoc="undefined"!=typeof document?document:null,r.currentWindow="undefined"!=typeof window?window:null,r.resizeObserver=null,r.previousCropSize=null,r.isInitialized=!1,r.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},r.initResizeObserver=function(){if(void 0!==window.ResizeObserver&&r.containerRef){var e=!0;r.resizeObserver=new window.ResizeObserver((function(t){e?e=!1:r.computeSizes()})),r.resizeObserver.observe(r.containerRef)}},r.preventZoomSafari=function(e){return e.preventDefault()},r.cleanEvents=function(){r.currentDoc&&(r.currentDoc.removeEventListener("mousemove",r.onMouseMove),r.currentDoc.removeEventListener("mouseup",r.onDragStopped),r.currentDoc.removeEventListener("touchmove",r.onTouchMove),r.currentDoc.removeEventListener("touchend",r.onDragStopped),r.currentDoc.removeEventListener("gesturechange",r.onGestureChange),r.currentDoc.removeEventListener("gestureend",r.onGestureEnd),r.currentDoc.removeEventListener("scroll",r.onScroll))},r.clearScrollEvent=function(){r.containerRef&&r.containerRef.removeEventListener("wheel",r.onWheel),r.wheelTimer&&clearTimeout(r.wheelTimer)},r.onMediaLoad=function(){var e=r.computeSizes();e&&(r.previousCropSize=e,r.emitCropData(),r.setInitialCrop(e),r.isInitialized=!0),r.props.onMediaLoaded&&r.props.onMediaLoaded(r.mediaSize)},r.setInitialCrop=function(e){if(r.props.initialCroppedAreaPercentages){var t=function(e,t,r,a,s,i){var n=Y(t.width,t.height,r),o=G(a.width/n.width*(100/e.width),s,i);return{crop:{x:o*n.width/2-a.width/2-n.width*o*(e.x/100),y:o*n.height/2-a.height/2-n.height*o*(e.y/100)},zoom:o}}(r.props.initialCroppedAreaPercentages,r.mediaSize,r.props.rotation,e,r.props.minZoom,r.props.maxZoom),a=t.crop,s=t.zoom;r.props.onCropChange(a),r.props.onZoomChange&&r.props.onZoomChange(s)}else if(r.props.initialCroppedAreaPixels){var i=function(e,t,r,a,s,i){void 0===r&&(r=0);var n=Y(t.naturalWidth,t.naturalHeight,r),o=G(function(e,t,r){var a=function(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}(t);return r.height>r.width?r.height/(e.height*a):r.width/(e.width*a)}(e,t,a),s,i),l=a.height>a.width?a.height/e.height:a.width/e.width;return{crop:{x:((n.width-e.width)/2-e.x)*l,y:((n.height-e.height)/2-e.y)*l},zoom:o}}(r.props.initialCroppedAreaPixels,r.mediaSize,r.props.rotation,e,r.props.minZoom,r.props.maxZoom);a=i.crop,s=i.zoom;r.props.onCropChange(a),r.props.onZoomChange&&r.props.onZoomChange(s)}},r.computeSizes=function(){var e,t,a,i,n,o,l=r.imageRef.current||r.videoRef.current;if(l&&r.containerRef){r.containerRect=r.containerRef.getBoundingClientRect(),r.saveContainerPosition();var d=r.containerRect.width/r.containerRect.height,c=(null===(e=r.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=r.videoRef.current)||void 0===t?void 0:t.videoWidth)||0,h=(null===(a=r.imageRef.current)||void 0===a?void 0:a.naturalHeight)||(null===(i=r.videoRef.current)||void 0===i?void 0:i.videoHeight)||0,x=c/h,m=void 0;if(l.offsetWidth<c||l.offsetHeight<h)switch(r.state.mediaObjectFit){default:case"contain":m=d>x?{width:r.containerRect.height*x,height:r.containerRect.height}:{width:r.containerRect.width,height:r.containerRect.width/x};break;case"horizontal-cover":m={width:r.containerRect.width,height:r.containerRect.width/x};break;case"vertical-cover":m={width:r.containerRect.height*x,height:r.containerRect.height}}else m={width:l.offsetWidth,height:l.offsetHeight};r.mediaSize=s(s({},m),{naturalWidth:c,naturalHeight:h}),r.props.setMediaSize&&r.props.setMediaSize(r.mediaSize);var g=r.props.cropSize?r.props.cropSize:function(e,t,r,a,s,i){void 0===i&&(i=0);var n=Y(e,t,i),o=n.width,l=n.height,d=Math.min(o,r),c=Math.min(l,a);return d>c*s?{width:c*s,height:c}:{width:d,height:d/s}}(r.mediaSize.width,r.mediaSize.height,r.containerRect.width,r.containerRect.height,r.props.aspect,r.props.rotation);return(null===(n=r.state.cropSize)||void 0===n?void 0:n.height)===g.height&&(null===(o=r.state.cropSize)||void 0===o?void 0:o.width)===g.width||r.props.onCropSizeChange&&r.props.onCropSizeChange(g),r.setState({cropSize:g},r.recomputeCropPosition),r.props.setCropSize&&r.props.setCropSize(g),g}},r.saveContainerPosition=function(){if(r.containerRef){var e=r.containerRef.getBoundingClientRect();r.containerPosition={x:e.left,y:e.top}}},r.onMouseDown=function(e){r.currentDoc&&(e.preventDefault(),r.currentDoc.addEventListener("mousemove",r.onMouseMove),r.currentDoc.addEventListener("mouseup",r.onDragStopped),r.saveContainerPosition(),r.onDragStart(t.getMousePoint(e)))},r.onMouseMove=function(e){return r.onDrag(t.getMousePoint(e))},r.onScroll=function(e){r.currentDoc&&(e.preventDefault(),r.saveContainerPosition())},r.onTouchStart=function(e){r.currentDoc&&(r.isTouching=!0,r.props.onTouchRequest&&!r.props.onTouchRequest(e)||(r.currentDoc.addEventListener("touchmove",r.onTouchMove,{passive:!1}),r.currentDoc.addEventListener("touchend",r.onDragStopped),r.saveContainerPosition(),2===e.touches.length?r.onPinchStart(e):1===e.touches.length&&r.onDragStart(t.getTouchPoint(e.touches[0]))))},r.onTouchMove=function(e){e.preventDefault(),2===e.touches.length?r.onPinchMove(e):1===e.touches.length&&r.onDrag(t.getTouchPoint(e.touches[0]))},r.onGestureStart=function(e){r.currentDoc&&(e.preventDefault(),r.currentDoc.addEventListener("gesturechange",r.onGestureChange),r.currentDoc.addEventListener("gestureend",r.onGestureEnd),r.gestureZoomStart=r.props.zoom,r.gestureRotationStart=r.props.rotation)},r.onGestureChange=function(e){if(e.preventDefault(),!r.isTouching){var a=t.getMousePoint(e),s=r.gestureZoomStart-1+e.scale;if(r.setNewZoom(s,a,{shouldUpdatePosition:!0}),r.props.onRotationChange){var i=r.gestureRotationStart+e.rotation;r.props.onRotationChange(i)}}},r.onGestureEnd=function(e){r.cleanEvents()},r.onDragStart=function(e){var t,a,i=e.x,n=e.y;r.dragStartPosition={x:i,y:n},r.dragStartCrop=s({},r.props.crop),null===(a=(t=r.props).onInteractionStart)||void 0===a||a.call(t)},r.onDrag=function(e){var t=e.x,a=e.y;r.currentWindow&&(r.rafDragTimeout&&r.currentWindow.cancelAnimationFrame(r.rafDragTimeout),r.rafDragTimeout=r.currentWindow.requestAnimationFrame((function(){if(r.state.cropSize&&void 0!==t&&void 0!==a){var e=t-r.dragStartPosition.x,s=a-r.dragStartPosition.y,i={x:r.dragStartCrop.x+e,y:r.dragStartCrop.y+s},n=r.props.restrictPosition?U(i,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):i;r.props.onCropChange(n)}})))},r.onDragStopped=function(){var e,t;r.isTouching=!1,r.cleanEvents(),r.emitCropData(),null===(t=(e=r.props).onInteractionEnd)||void 0===t||t.call(e)},r.onWheel=function(e){if(r.currentWindow&&(!r.props.onWheelRequest||r.props.onWheelRequest(e))){e.preventDefault();var a=t.getMousePoint(e),s=W(e).pixelY,i=r.props.zoom-s*r.props.zoomSpeed/200;r.setNewZoom(i,a,{shouldUpdatePosition:!0}),r.state.hasWheelJustStarted||r.setState({hasWheelJustStarted:!0},(function(){var e,t;return null===(t=(e=r.props).onInteractionStart)||void 0===t?void 0:t.call(e)})),r.wheelTimer&&clearTimeout(r.wheelTimer),r.wheelTimer=r.currentWindow.setTimeout((function(){return r.setState({hasWheelJustStarted:!1},(function(){var e,t;return null===(t=(e=r.props).onInteractionEnd)||void 0===t?void 0:t.call(e)}))}),250)}},r.getPointOnContainer=function(e,t){var a=e.x,s=e.y;if(!r.containerRect)throw new Error("The Cropper is not mounted");return{x:r.containerRect.width/2-(a-t.x),y:r.containerRect.height/2-(s-t.y)}},r.getPointOnMedia=function(e){var t=e.x,a=e.y,s=r.props,i=s.crop,n=s.zoom;return{x:(t+i.x)/n,y:(a+i.y)/n}},r.setNewZoom=function(e,t,a){var s=(void 0===a?{}:a).shouldUpdatePosition,i=void 0===s||s;if(r.state.cropSize&&r.props.onZoomChange){var n=G(e,r.props.minZoom,r.props.maxZoom);if(i){var o=r.getPointOnContainer(t,r.containerPosition),l=r.getPointOnMedia(o),d={x:l.x*n-o.x,y:l.y*n-o.y},c=r.props.restrictPosition?U(d,r.mediaSize,r.state.cropSize,n,r.props.rotation):d;r.props.onCropChange(c)}r.props.onZoomChange(n)}},r.getCropData=function(){return r.state.cropSize?function(e,t,r,a,i,n,o){void 0===n&&(n=0),void 0===o&&(o=!0);var l=o?Z:V,d=Y(t.width,t.height,n),c=Y(t.naturalWidth,t.naturalHeight,n),h={x:l(100,((d.width-r.width/i)/2-e.x/i)/d.width*100),y:l(100,((d.height-r.height/i)/2-e.y/i)/d.height*100),width:l(100,r.width/d.width*100/i),height:l(100,r.height/d.height*100/i)},x=Math.round(l(c.width,h.width*c.width/100)),m=Math.round(l(c.height,h.height*c.height/100)),g=c.width>=c.height*a?{width:Math.round(m*a),height:m}:{width:x,height:Math.round(x/a)};return{croppedAreaPercentages:h,croppedAreaPixels:s(s({},g),{x:Math.round(l(c.width-g.width,h.x*c.width/100)),y:Math.round(l(c.height-g.height,h.y*c.height/100))})}}(r.props.restrictPosition?U(r.props.crop,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):r.props.crop,r.mediaSize,r.state.cropSize,r.getAspect(),r.props.zoom,r.props.rotation,r.props.restrictPosition):null},r.emitCropData=function(){var e=r.getCropData();if(e){var t=e.croppedAreaPercentages,a=e.croppedAreaPixels;r.props.onCropComplete&&r.props.onCropComplete(t,a),r.props.onCropAreaChange&&r.props.onCropAreaChange(t,a)}},r.emitCropAreaChange=function(){var e=r.getCropData();if(e){var t=e.croppedAreaPercentages,a=e.croppedAreaPixels;r.props.onCropAreaChange&&r.props.onCropAreaChange(t,a)}},r.recomputeCropPosition=function(){var e,t;if(r.state.cropSize){var a=r.props.crop;if(r.isInitialized&&(null===(e=r.previousCropSize)||void 0===e?void 0:e.width)&&(null===(t=r.previousCropSize)||void 0===t?void 0:t.height))if(Math.abs(r.previousCropSize.width-r.state.cropSize.width)>1e-6||Math.abs(r.previousCropSize.height-r.state.cropSize.height)>1e-6){var s=r.state.cropSize.width/r.previousCropSize.width,i=r.state.cropSize.height/r.previousCropSize.height;a={x:r.props.crop.x*s,y:r.props.crop.y*i}}var n=r.props.restrictPosition?U(a,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):a;r.previousCropSize=r.state.cropSize,r.props.onCropChange(n),r.emitCropData()}},r.onKeyDown=function(e){var t,a,i=r.props,n=i.crop,o=i.onCropChange,l=i.keyboardStep,d=i.zoom,c=i.rotation,h=l;if(r.state.cropSize){e.shiftKey&&(h*=.2);var x=s({},n);switch(e.key){case"ArrowUp":x.y-=h,e.preventDefault();break;case"ArrowDown":x.y+=h,e.preventDefault();break;case"ArrowLeft":x.x-=h,e.preventDefault();break;case"ArrowRight":x.x+=h,e.preventDefault();break;default:return}r.props.restrictPosition&&(x=U(x,r.mediaSize,r.state.cropSize,d,c)),e.repeat||null===(a=(t=r.props).onInteractionStart)||void 0===a||a.call(t),o(x)}},r.onKeyUp=function(e){var t,a;switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":e.preventDefault();break;default:return}r.emitCropData(),null===(a=(t=r.props).onInteractionEnd)||void 0===a||a.call(t)},r}return a(t,e),t.prototype.componentDidMount=function(){this.currentDoc&&this.currentWindow&&(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),void 0===window.ResizeObserver&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=".reactEasyCrop_Container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  user-select: none;\n  touch-action: none;\n  cursor: move;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.reactEasyCrop_Image,\n.reactEasyCrop_Video {\n  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */\n}\n\n.reactEasyCrop_Contain {\n  max-width: 100%;\n  max-height: 100%;\n  margin: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactEasyCrop_Cover_Horizontal {\n  width: 100%;\n  height: auto;\n}\n.reactEasyCrop_Cover_Vertical {\n  width: auto;\n  height: 100%;\n}\n\n.reactEasyCrop_CropArea {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  box-sizing: border-box;\n  box-shadow: 0 0 0 9999em;\n  color: rgba(0, 0, 0, 0.5);\n  overflow: hidden;\n}\n\n.reactEasyCrop_CropAreaRound {\n  border-radius: 50%;\n}\n\n.reactEasyCrop_CropAreaGrid::before {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 0;\n  bottom: 0;\n  left: 33.33%;\n  right: 33.33%;\n  border-top: 0;\n  border-bottom: 0;\n}\n\n.reactEasyCrop_CropAreaGrid::after {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 33.33%;\n  bottom: 33.33%;\n  left: 0;\n  right: 0;\n  border-left: 0;\n  border-right: 0;\n}\n",this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},t.prototype.componentWillUnmount=function(){var e,t;this.currentDoc&&this.currentWindow&&(void 0===window.ResizeObserver&&this.currentWindow.removeEventListener("resize",this.computeSizes),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&(null===(t=this.styleRef.parentNode)||void 0===t||t.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},t.prototype.componentDidUpdate=function(e){var t,r,a,s,i,n,o,l,d;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect||e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():(null===(t=e.cropSize)||void 0===t?void 0:t.height)!==(null===(r=this.props.cropSize)||void 0===r?void 0:r.height)||(null===(a=e.cropSize)||void 0===a?void 0:a.width)!==(null===(s=this.props.cropSize)||void 0===s?void 0:s.width)?this.computeSizes():(null===(i=e.crop)||void 0===i?void 0:i.x)===(null===(n=this.props.crop)||void 0===n?void 0:n.x)&&(null===(o=e.crop)||void 0===o?void 0:o.y)===(null===(l=this.props.crop)||void 0===l?void 0:l.y)||this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&(null===(d=this.videoRef.current)||void 0===d||d.load());var c=this.getObjectFit();c!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:c},this.computeSizes)},t.prototype.getAspect=function(){var e=this.props,t=e.cropSize,r=e.aspect;return t?t.width/t.height:r},t.prototype.getObjectFit=function(){var e,t,r,a;if("cover"===this.props.objectFit){if((this.imageRef.current||this.videoRef.current)&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var s=this.containerRect.width/this.containerRect.height;return((null===(e=this.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=this.videoRef.current)||void 0===t?void 0:t.videoWidth)||0)/((null===(r=this.imageRef.current)||void 0===r?void 0:r.naturalHeight)||(null===(a=this.videoRef.current)||void 0===a?void 0:a.videoHeight)||0)<s?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},t.prototype.onPinchStart=function(e){var r=t.getTouchPoint(e.touches[0]),a=t.getTouchPoint(e.touches[1]);this.lastPinchDistance=B(r,a),this.lastPinchRotation=$(r,a),this.onDragStart(H(r,a))},t.prototype.onPinchMove=function(e){var r=this;if(this.currentDoc&&this.currentWindow){var a=t.getTouchPoint(e.touches[0]),s=t.getTouchPoint(e.touches[1]),i=H(a,s);this.onDrag(i),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame((function(){var e=B(a,s),t=r.props.zoom*(e/r.lastPinchDistance);r.setNewZoom(t,i,{shouldUpdatePosition:!1}),r.lastPinchDistance=e;var n=$(a,s),o=r.props.rotation+(n-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(o),r.lastPinchRotation=n}))}},t.prototype.render=function(){var e,t=this,r=this.props,a=r.image,i=r.video,o=r.mediaProps,l=r.cropperProps,d=r.transform,c=r.crop,h=c.x,x=c.y,m=r.rotation,g=r.zoom,u=r.cropShape,p=r.showGrid,y=r.roundCropAreaPixels,b=r.style,f=b.containerStyle,v=b.cropAreaStyle,w=b.mediaStyle,j=r.classes,k=j.containerClassName,N=j.cropAreaClassName,C=j.mediaClassName,S=null!==(e=this.state.mediaObjectFit)&&void 0!==e?e:this.getObjectFit();return n.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(e){return t.containerRef=e},"data-testid":"container",style:f,className:X("reactEasyCrop_Container",k)},a?n.createElement("img",s({alt:"",className:X("reactEasyCrop_Image","contain"===S&&"reactEasyCrop_Contain","horizontal-cover"===S&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===S&&"reactEasyCrop_Cover_Vertical",C)},o,{src:a,ref:this.imageRef,style:s(s({},w),{transform:d||"translate(".concat(h,"px, ").concat(x,"px) rotate(").concat(m,"deg) scale(").concat(g,")")}),onLoad:this.onMediaLoad})):i&&n.createElement("video",s({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:X("reactEasyCrop_Video","contain"===S&&"reactEasyCrop_Contain","horizontal-cover"===S&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===S&&"reactEasyCrop_Cover_Vertical",C)},o,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:s(s({},w),{transform:d||"translate(".concat(h,"px, ").concat(x,"px) rotate(").concat(m,"deg) scale(").concat(g,")")}),controls:!1}),(Array.isArray(i)?i:[{src:i}]).map((function(e){return n.createElement("source",s({key:e.src},e))}))),this.state.cropSize&&n.createElement("div",s({ref:this.cropperRef,style:s(s({},v),{width:y?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:y?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:X("reactEasyCrop_CropArea","round"===u&&"reactEasyCrop_CropAreaRound",p&&"reactEasyCrop_CropAreaGrid",N)},l)))},t.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:3,minZoom:1,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:1},t.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},t.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},t}(n.Component);async function J(e,t){const r=await(a=e,new Promise(((e,t)=>{const r=new Image;r.addEventListener("load",(()=>e(r))),r.addEventListener("error",(e=>t(e))),r.src=a})));var a;const s=document.createElement("canvas"),i=s.getContext("2d");if(!i)throw new Error("No 2d context");return s.width=t.width,s.height=t.height,i.drawImage(r,t.x,t.y,t.width,t.height,0,0,t.width,t.height),new Promise(((e,t)=>{s.toBlob((r=>{r?e(r):t(new Error("Canvas is empty"))}),"image/jpeg")}))}const Q=({onClose:e})=>{const[a,s]=n.useState([]),[i,o]=n.useState(0),[d,c]=n.useState(""),[h,x]=n.useState({x:0,y:0}),[m,g]=n.useState(1),[u,p]=n.useState(null),[y,b]=n.useState(!1),[f,v]=n.useState({current:0,total:0}),w=n.useCallback(((e,t)=>{p(t)}),[]);return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-auto",children:[r.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Add New Hero Image"})}),r.jsxs("form",{onSubmit:async r=>{if(r.preventDefault(),0!==a.length&&u){b(!0),v({current:0,total:a.length});try{const r=a[i],s=await J(d,u),n=`${Date.now()}_${r.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,l=t.storage.from("hero-images").upload(n,s,{contentType:"image/jpeg",cacheControl:"3600",upsert:!1}),h=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Upload timeout - please check your internet connection"))),6e4)})),{data:m,error:y}=await Promise.race([l,h]);if(y)throw new Error(`Storage upload failed: ${y.message}`);const{data:{publicUrl:b}}=t.storage.from("hero-images").getPublicUrl(n),{error:f}=await t.from("hero_images").insert({title:r.name.replace(/\.[^/.]+$/,""),alt_text:null,image_url:b,is_active:!0});if(f)throw await t.storage.from("hero-images").remove([n]),new Error(`Database insert failed: ${f.message}`);v({current:i+1,total:a.length}),i+1<a.length?((()=>{const e=i+1;if(e<a.length){o(e);const t=new FileReader;t.onloadend=()=>{c(t.result),x({x:0,y:0}),g(1)},t.readAsDataURL(a[e])}})(),p(null)):(alert(`Successfully uploaded ${a.length} image(s)!`),e())}catch(s){alert(`Failed to upload image ${i+1}: ${s.message||"Unknown error"}`)}finally{b(!1)}}else alert("Please select at least one image and adjust the crop")},className:"p-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select Images *"}),r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=Array.from(e.target.files);s(t),o(0);const r=new FileReader;r.onloadend=()=>{c(r.result),x({x:0,y:0}),g(1)},r.readAsDataURL(t[0])}},multiple:!0,required:!0,className:"block w-full text-sm text-gray-900 dark:text-gray-300 \r\n                         file:mr-4 file:py-2 file:px-4\r\n                         file:rounded file:border-0\r\n                         file:text-sm file:font-semibold\r\n                         file:bg-blue-50 file:text-blue-700\r\n                         dark:file:bg-blue-900 dark:file:text-blue-300\r\n                         hover:file:bg-blue-100 dark:hover:file:bg-blue-800"}),a.length>0&&r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:[a.length," file(s) selected. Cropping image ",i+1," of ",a.length]})]}),d&&r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Crop Image ",i+1]}),r.jsx("div",{className:"relative h-96 bg-gray-200 dark:bg-gray-700 rounded",children:r.jsx(K,{image:d,crop:h,zoom:m,aspect:16/9,onCropChange:x,onCropComplete:w,onZoomChange:g})}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zoom"}),r.jsx("input",{type:"range",value:m,min:1,max:3,step:.1,onChange:e=>g(Number(e.target.value)),className:"w-full"})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[r.jsx(l,{type:"button",onClick:e,className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500",disabled:y,children:"Cancel"}),r.jsx(l,{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",disabled:y||0===a.length,children:y?i+1<a.length?`Upload & Next (${f.current}/${f.total})`:`Uploading (${f.current}/${f.total})...`:i+1<a.length?`Upload & Next (${i+1}/${a.length})`:"Upload "+(a.length>1?"All":"Image")})]})]})]})})},ee=()=>{const{user:a,signOut:s}=e(),o=i(),[d,h]=n.useState([]),[x,m]=n.useState(!0),[g,u]=n.useState(0),[p,y]=n.useState(!1),[b,f]=n.useState(null);n.useEffect((()=>{v()}),[]);const v=async(e=!1)=>{try{m(!0);const{data:r,error:a}=await t.from("hero_images").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(a)throw a;const s=r||[];h(s),e&&s.length>0&&u(0)}catch(r){}finally{m(!1)}};n.useEffect((()=>{if(0===d.length)return;const e=setInterval((()=>{u((e=>(e+1)%d.length))}),5e3);return()=>clearInterval(e)}),[d.length]),n.useEffect((()=>{g>=d.length&&u(0)}),[d.length,g]);return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("button",{onClick:()=>o("/admin/dashboard"),className:"text-blue-600 dark:text-blue-400 hover:underline mb-2 text-sm",children:"â† Back to Dashboard"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Hero Images"}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:null==a?void 0:a.email})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(l,{onClick:()=>y(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"+ Add New Image"}),r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})]})]})})}),r.jsxs("main",{className:"h-[calc(100vh-120px)] flex gap-4 px-4 sm:px-6 lg:px-8 py-4",children:[r.jsxs("div",{className:"w-1/2 overflow-y-auto",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Your Images"}),x?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):r.jsx(r.Fragment,{children:0===d.length?r.jsx("div",{className:"text-center py-12 text-gray-500",children:'No hero images yet. Click "Add New Image" to get started.'}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((e=>r.jsxs("div",{className:"relative group rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-shadow bg-white dark:bg-gray-800",children:[r.jsx("button",{onClick:()=>(async(e,t)=>{f({id:e,imageUrl:t})})(e.id,e.image_url),className:"absolute top-2 right-2 z-10 w-8 h-8 flex items-center justify-center bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg opacity-0 group-hover:opacity-100",title:"Delete image",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("div",{className:"aspect-video w-full overflow-hidden bg-gray-200 dark:bg-gray-700",children:r.jsx("img",{src:e.image_url,alt:e.title||"Hero image",className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"p-2",children:[e.title&&r.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.title}),e.subtitle&&r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:e.subtitle})]})]},e.id)))})})]}),r.jsxs("div",{className:"w-1/2 sticky top-0",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Live Preview"}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden border-2 border-gray-300 dark:border-gray-600 p-4",children:r.jsx(c,{preview:!0})}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"Preview shows the first active image as it will appear on your homepage"})]})]}),p&&r.jsx(Q,{onClose:()=>{y(!1),v(!0)}}),b&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsx("h3",{className:"ml-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Image"})]}),r.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete this image? This action is ",r.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:"IRREVERSIBLE"})," and the image will be permanently removed."]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(l,{onClick:()=>f(null),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-900 dark:text-white",children:"Cancel"}),r.jsx(l,{onClick:async()=>{if(b)try{const{error:e}=await t.from("hero_images").update({is_active:!1}).eq("id",b.id);if(e)throw e;f(null),v(!0)}catch(e){alert("Failed to delete image")}},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})})]})},te=({onClose:e})=>{const[a,s]=n.useState(""),[i,o]=n.useState(""),[c,h]=n.useState([]),[x,m]=n.useState(!1),[g,u]=n.useState({current:0,total:0});return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-auto",children:[r.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Add Client Logo"})}),r.jsxs("form",{onSubmit:async r=>{if(r.preventDefault(),0!==c.length)if(a.trim()){m(!0),u({current:0,total:c.length});try{for(let e=0;e<c.length;e++){const r=c[e],s=`${Date.now()}_${r.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,n=t.storage.from("client-logos").upload(s,r,{contentType:r.type,cacheControl:"3600",upsert:!1}),o=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Upload timeout"))),6e4)})),{data:l,error:d}=await Promise.race([n,o]);if(d)throw new Error(`Storage upload failed: ${d.message}`);const{data:{publicUrl:h}}=t.storage.from("client-logos").getPublicUrl(s),{error:x}=await t.from("client_logos").insert({company_name:a,logo_url:h,website_url:i||null,alt_text:`${a} logo`,is_active:!0});if(x)throw await t.storage.from("client-logos").remove([s]),new Error(`Database insert failed: ${x.message}`);u({current:e+1,total:c.length})}alert(`Successfully uploaded ${c.length} logo(s)!`),e()}catch(s){alert(`Failed to upload logo: ${s.message||"Unknown error"}`)}finally{m(!1)}}else alert("Please enter a company name");else alert("Please select at least one logo file")},className:"p-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company Name *"}),r.jsx(d,{type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"Enter company name",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Website URL (optional)"}),r.jsx(d,{type:"url",value:i,onChange:e=>o(e.target.value),placeholder:"https://company.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Logo File(s) * (PNG, JPG, SVG)"}),r.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/svg+xml",onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=Array.from(e.target.files);h(t)}},multiple:!0,required:!0,className:"block w-full text-sm text-gray-900 dark:text-gray-300 \r\n                         file:mr-4 file:py-2 file:px-4\r\n                         file:rounded file:border-0\r\n                         file:text-sm file:font-semibold\r\n                         file:bg-blue-50 file:text-blue-700\r\n                         dark:file:bg-blue-900 dark:file:text-blue-300\r\n                         hover:file:bg-blue-100 dark:hover:file:bg-blue-800"}),c.length>0&&r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:[c.length," file(s) selected"]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[r.jsx(l,{type:"button",onClick:e,className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500",disabled:x,children:"Cancel"}),r.jsx(l,{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",disabled:x||0===c.length,children:x?`Uploading (${g.current}/${g.total})...`:"Upload "+(c.length>1?"All":"Logo")})]})]})]})})},re=({images:e,fit:t=.8,minRadius:a=600,maxVerticalRotationDeg:s=0,segments:i=34,dragDampening:o=2,grayscale:l=!0})=>{const d=n.useRef(null),c=n.useRef(null),h=n.useRef({x:0,y:0}),x=n.useRef(null),m=n.useMemo((()=>{const t=Array.from({length:i},((e,t)=>2*t-37)),r=[-4,-2,0,2,4],a=[-3,-1,1,3,5],s=t.flatMap(((e,t)=>(t%2==0?r:a).map((t=>({x:e,y:t,sizeX:2,sizeY:2}))))),n=s.length,o=Array.from({length:n},((t,r)=>e[r%e.length]));return s.map(((e,t)=>({...e,src:o[t]})))}),[e,i]),g=n.useCallback(((e,t)=>{const r=c.current;r&&(r.style.transform=`translateZ(calc(var(--radius) * -1)) rotateX(${e}deg) rotateY(${t}deg)`)}),[]);n.useEffect((()=>{const e=()=>{h.current.y=(h.current.y+.1)%360,g(h.current.x,h.current.y),x.current=requestAnimationFrame(e)};return x.current=requestAnimationFrame(e),()=>{x.current&&cancelAnimationFrame(x.current)}}),[g]),n.useEffect((()=>{const e=d.current;if(!e)return;const r=()=>{const r=e.getBoundingClientRect(),s=Math.max(1,r.width),i=Math.max(1,r.height);let n=Math.min(s,i)*t;const o=1.35*i;var d,c,h;n=Math.min(n,o),d=n,c=a,h=1/0,n=Math.min(Math.max(d,c),h),e.style.setProperty("--radius",`${Math.round(n)}px`),e.style.setProperty("--image-filter",l?"grayscale(1)":"none")},s=new ResizeObserver(r);return s.observe(e),r(),()=>s.disconnect()}),[t,a,l]);return r.jsx("div",{ref:d,className:"client-dome-root",style:{"--segments-x":i,"--segments-y":i,"--image-filter":l?"grayscale(1)":"none"},children:r.jsxs("div",{className:"client-dome-main",children:[r.jsx("div",{className:"client-dome-stage",children:r.jsx("div",{ref:c,className:"client-dome-sphere",children:m.map(((e,t)=>{const a=((e,t,r,a)=>{const s=360/i/2;return{rotateX:s*(t-(a-1)/2),rotateY:s*(e+(r-1)/2)}})(e.x,e.y,e.sizeX,e.sizeY);return r.jsx("div",{className:"client-dome-item",style:{"--offset-x":e.x,"--offset-y":e.y,"--item-size-x":e.sizeX,"--item-size-y":e.sizeY,transform:`rotateY(${a.rotateY}deg) rotateX(${a.rotateX}deg) translateZ(var(--radius))`},children:r.jsx("div",{className:"client-dome-item__image",children:r.jsx("img",{src:e.src,draggable:!1,alt:"Client logo"})})},`${e.x},${e.y},${t}`)}))})}),r.jsx("div",{className:"client-dome-overlay"}),r.jsx("div",{className:"client-dome-overlay client-dome-overlay--blur"})]})})},ae=()=>{const{user:a,signOut:s}=e(),o=i(),[d,c]=n.useState([]),[h,x]=n.useState(!0),[m,g]=n.useState(!1),[u,p]=n.useState(null),[y,b]=n.useState(0),[f,v]=n.useState("3d");n.useEffect((()=>{w()}),[]),n.useEffect((()=>{if(0===d.length)return;const e=setInterval((()=>{b((e=>(e+1)%d.length))}),3e3);return()=>clearInterval(e)}),[d.length]);const w=async()=>{try{x(!0);const{data:e,error:r}=await t.from("client_logos").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(r)throw r;c(e||[])}catch(e){}finally{x(!1)}},j=d.map((e=>e.logo_url)),k=j;return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("button",{onClick:()=>o("/admin/dashboard"),className:"text-blue-600 dark:text-blue-400 hover:underline mb-2 text-sm",children:"â† Back to Dashboard"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Client Logos"}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:null==a?void 0:a.email})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(l,{onClick:()=>g(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"+ Add New Logo"}),r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})]})]})})}),r.jsxs("main",{className:"h-[calc(100vh-120px)] flex flex-col lg:flex-row gap-4 px-4 sm:px-6 lg:px-8 py-4",children:[r.jsxs("div",{className:"w-full lg:w-1/2 overflow-y-auto pr-2",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Your Logos"}),r.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[d.length," ",1===d.length?"logo":"logos"]})]}),h?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):r.jsx(r.Fragment,{children:0===d.length?r.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),r.jsx("p",{className:"mt-4",children:"No client logos yet."}),r.jsx("p",{className:"text-sm mt-1",children:'Click "Add New Logo" to get started.'})]}):r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:d.map((e=>r.jsxs("div",{className:"relative group rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-shadow bg-white dark:bg-gray-800 p-3",children:[r.jsx("button",{onClick:()=>(async(e,t)=>{p({id:e,logoUrl:t})})(e.id,e.logo_url),className:"absolute top-2 right-2 z-10 w-8 h-8 flex items-center justify-center bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg opacity-0 group-hover:opacity-100",title:"Delete logo",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("div",{className:"aspect-square w-full flex items-center justify-center bg-gray-100 dark:bg-gray-700 rounded p-2",children:r.jsx("img",{src:e.logo_url,alt:e.company_name,className:"max-w-full max-h-full object-contain"})}),r.jsxs("div",{className:"mt-2 text-center",children:[r.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-white truncate",children:e.company_name}),r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Added: ",new Date(e.created_at).toLocaleDateString()]})]})]},e.id)))})})]}),r.jsxs("div",{className:"w-full lg:w-1/2 sticky top-0",children:[r.jsxs("div",{className:"relative rounded-lg overflow-hidden shadow-lg h-72 md:h-80 bg-white dark:bg-gray-800 p-4 md:p-8 border-2 border-gray-300 dark:border-gray-600",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Live Preview"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:"View:"}),r.jsxs("div",{className:"flex border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden",children:[r.jsx("button",{onClick:()=>v("2d"),className:"px-3 py-1 text-sm font-medium transition-colors "+("2d"===f?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"2D Grid"}),r.jsx("button",{onClick:()=>v("3d"),className:"px-3 py-1 text-sm font-medium transition-colors "+("3d"===f?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"3D Sphere"})]})]})]}),0===d.length?r.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[r.jsx("svg",{className:"w-16 h-16 mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),r.jsx("p",{children:"No logos to preview"}),r.jsx("p",{className:"text-sm mt-1",children:"Add logos to see them here"})]}):r.jsxs("div",{className:"space-y-6",children:["2d"===f?r.jsx(r.Fragment,{children:r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-center text-gray-900 dark:text-white mb-6",children:"Our Trusted Partners"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"flex items-center justify-center mb-4",children:r.jsx("div",{className:"w-48 h-48 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center p-6 shadow-md",children:r.jsx("img",{src:d[y].logo_url,alt:d[y].company_name,className:"max-w-full max-h-full object-contain"})})}),r.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:d.map(((e,t)=>r.jsx("button",{onClick:()=>b(t),"aria-label":`Go to logo ${t+1}`,className:"w-2 h-2 rounded-full "+(t===y?"bg-blue-600":"bg-gray-300")},t)))})]}),r.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg",children:d.map((e=>r.jsx("div",{className:"aspect-square flex items-center justify-center bg-white dark:bg-gray-800 rounded-lg p-3 hover:shadow-md transition-shadow border border-gray-200 dark:border-gray-700",children:r.jsx("img",{src:e.logo_url,alt:e.company_name,className:"max-w-full max-h-full object-contain filter grayscale hover:grayscale-0 transition-all duration-300",title:e.company_name})},e.id)))})]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-full rounded-lg overflow-hidden border flex items-start justify-center pb-6",children:r.jsx(re,{images:k,fit:.8,minRadius:600,maxVerticalRotationDeg:0,segments:34,dragDampening:2,grayscale:!1})}),r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Drag to rotate the sphere â€¢ Logos automatically rotate"}),r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Showing ",j.length," logos in 3D sphere view"]})]})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Logos"}),r.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:d.length})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Preview Mode"}),r.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:f.toUpperCase()})]})]})})]})]}),r.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.jsx("span",{className:"font-medium",children:"Live Preview:"})," Changes made to logos will instantly update in the preview above.","3d"===f&&" Drag the 3D sphere to rotate it."]})]})})]})]}),m&&r.jsx(te,{onClose:()=>{g(!1),w()}}),u&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsx("h3",{className:"ml-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Logo"})]}),r.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete this logo? This action is ",r.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:"IRREVERSIBLE"})," and the logo will be permanently removed."]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(l,{onClick:()=>p(null),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-900 dark:text-white",children:"Cancel"}),r.jsx(l,{onClick:async()=>{if(u)try{const{error:e}=await t.from("client_logos").update({is_active:!1}).eq("id",u.id);if(e)throw e;p(null),w()}catch(e){alert("Failed to delete logo")}},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})})]})},se=[];for(let ue=0;ue<256;++ue)se.push((ue+256).toString(16).slice(1));let ie;const ne=new Uint8Array(16);const oe={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function le(e,t,r){var a;const s=(e=e||{}).random??(null==(a=e.rng)?void 0:a.call(e))??function(){if(!ie){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ie=crypto.getRandomValues.bind(crypto)}return ie(ne)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=15&s[6]|64,s[8]=63&s[8]|128,function(e,t=0){return(se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]).toLowerCase()}(s)}function de(e,t,r){return oe.randomUUID&&!e?oe.randomUUID():le(e)}const ce=({onClose:e,project:a,onSaved:s})=>{var i;const[o,c]=n.useState(!1),[h,x]=n.useState(!1),[m,g]=n.useState(null),[u,p]=n.useState((null==a?void 0:a.id)||""),[y,b]=n.useState((null==a?void 0:a.title)||""),[f,v]=n.useState((null==a?void 0:a.category)||""),[w,j]=n.useState([]),[k,N]=n.useState(""),[C,S]=n.useState((null==a?void 0:a.description)||""),[_,D]=n.useState((null==a?void 0:a.long_description)||""),[z,R]=n.useState((null==a?void 0:a.featured_image_url)||""),[P,E]=n.useState((null==a?void 0:a.image_alt)||""),[M,L]=n.useState((null==a?void 0:a.year)||(new Date).getFullYear().toString()),[A,I]=n.useState((null==a?void 0:a.client)||""),[F,T]=n.useState((null==a?void 0:a.role)||""),[q,W]=n.useState((null==a?void 0:a.duration)||""),[U,O]=n.useState((null==a?void 0:a.outcome)||""),[B,$]=n.useState((null==(i=null==a?void 0:a.technologies)?void 0:i.join(", "))||""),[Z,V]=n.useState((null==a?void 0:a.metrics)||[]),[H,Y]=n.useState(((null==a?void 0:a.gallery)||[]).map((e=>({id:e.id||de(),url:e.url,alt:e.alt})))),[G,X]=n.useState({current:0,total:0});n.useEffect((()=>{(async()=>{const{data:e,error:r}=await t.from("project_types").select("id, type_key, description").order("type_key",{ascending:!0});r||(j(e||[]),a&&a.type_id&&N(a.type_id))})()}),[]);const[K,J]=n.useState(""),[Q,ee]=n.useState(""),[te,re]=n.useState(!1),[ae,se]=n.useState((null==a?void 0:a.featured)||!1),ie=async(e,r="main")=>{try{x(!0);const a=e.name.split(".").pop(),s=`${r}/${Date.now()}-${Math.random().toString(36).substring(7)}.${a}`,{data:i,error:n}=await t.storage.from("project-images").upload(s,e,{cacheControl:"3600",upsert:!1});if(n)throw n;const{data:{publicUrl:o}}=t.storage.from("project-images").getPublicUrl(s);return o}catch(a){throw new Error("Failed to upload image: "+a.message)}finally{x(!1)}},ne=async(e,t=1600,r=.8)=>{try{if(!e.type.startsWith("image/"))return e;const a=await createImageBitmap(e),s=Math.min(1,t/a.width),i=document.createElement("canvas");i.width=Math.max(1,Math.round(a.width*s)),i.height=Math.max(1,Math.round(a.height*s));const n=i.getContext("2d");if(!n)return e;n.drawImage(a,0,0,i.width,i.height);const o=await new Promise((e=>i.toBlob(e,"image/jpeg",r)));if(!o)return e;return new File([o],e.name.replace(/\.[^/.]+$/,".jpg"),{type:"image/jpeg"})}catch(a){return e}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 overflow-y-auto",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl my-8",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between sticky top-0 bg-white dark:bg-gray-800 z-10",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a?"Edit Project":"Add New Project"}),r.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("form",{onSubmit:async r=>{r.preventDefault(),c(!0),g(null);try{const r=[];if(y||r.push("title"),_||r.push("longDescription"),z||r.push("featuredImageUrl"),M||r.push("year"),A||r.push("client"),q||r.push("duration"),r.length)throw new Error("Please fill in all required fields: "+r.join(", "));const i={...a?{}:{id:de()},title:y,long_description:_,featured_image_url:z,image_alt:P,year:M,client:A,duration:q,metrics:Z,featured:ae,is_active:!0,type_id:k||null};let n=(null==a?void 0:a.id)||u||null;if(a){const{error:e}=await t.from("projects").update(i).eq("id",a.id);if(e)throw e}else{const{data:e,error:r}=await t.from("projects").insert([i]).select().single();if(r)throw r;n=e.id}if(n){const{error:e}=await t.from("project_gallery").delete().eq("project_id",n);if(e)throw e;if((H||[]).length){const e=H.map((e=>({project_id:n,url:e.url,alt:e.alt||null}))),{error:r}=await t.from("project_gallery").insert(e);if(r)throw r}}null==s||s(),e()}catch(i){g(i.message||"Failed to save project")}finally{c(!1)}},className:"p-6 space-y-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[m&&r.jsx("div",{className:"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 p-3 rounded",children:m}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Basic Information"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx(d,{label:"Year",value:M,onChange:e=>L(e.target.value),placeholder:"e.g., 2025",required:!0}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Type"}),r.jsxs("select",{value:k||"",onChange:e=>N(e.target.value),className:"...",children:[r.jsx("option",{value:"",children:"Select a type"}),w.map((e=>r.jsxs("option",{value:e.id,children:[e.type_key.replace("_"," ").toUpperCase()," ",e.description?`â€” ${e.description}`:""]},e.id)))]})]}),r.jsx(d,{label:"Duration",value:q,onChange:e=>W(e.target.value),placeholder:"e.g., 3 months",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(d,{label:"Client",value:A,onChange:e=>I(e.target.value),placeholder:"e.g., GlobalCorp",required:!0}),r.jsx(d,{label:"Title",value:y,onChange:e=>b(e.target.value),placeholder:"e.g., Corporate Social Responsibility",required:!0})]}),r.jsxs("div",{className:"space-y-4 border-t pt-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Full Description"}),r.jsx("div",{children:r.jsx("textarea",{value:_,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:4,placeholder:"Detailed project description for case study",required:!0,"aria-multiline":!0})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Main Image"}),r.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(r)try{const e=await ie(r,"main"),t=r.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ");R(e),E(t)}catch(a){g(a.message)}},disabled:h,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!z}),h&&r.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Uploading..."}),r.jsx("div",{className:"mt-4",children:r.jsxs("div",{className:"space-y-6 bg-white dark:bg-neutral-900 p-0",children:[r.jsx("div",{className:"rounded-lg overflow-hidden",children:z?r.jsx("img",{src:z,alt:P,className:"w-full h-30 object-cover"}):r.jsx("div",{className:"w-full h-30 bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-sm text-gray-500",children:"No main image"})}),r.jsx("p",{className:"text-base text-neutral-600 dark:text-neutral-400",children:_}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Client"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:A})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Duration"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:q})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Year"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:M})]})]}),Z&&Z.length>0&&r.jsx("div",{className:"grid grid-cols-2 gap-4",children:Z.map(((e,t)=>r.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-800 rounded-lg p-4",children:[r.jsx("p",{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100",children:e.value}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:e.label})]},t)))}),H&&H.length>0&&r.jsxs("div",{className:"mt-6",children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:"Gallery"}),r.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-thin scrollbar-thumb-neutral-400 scrollbar-track-neutral-200 dark:scrollbar-thumb-neutral-600 dark:scrollbar-track-neutral-800",children:H.map(((e,t)=>r.jsx("div",{className:"flex-shrink-0 w-64 snap-center",children:r.jsx("div",{className:"rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:e.url.endsWith(".mp4")?r.jsx("video",{src:e.url,controls:!0,className:"w-full h-48 object-cover"}):r.jsx("img",{src:e.url,alt:e.alt,className:"w-full h-48 object-cover hover:scale-105 transition-transform duration-300"})})},t)))})]})]})})]})]}),r.jsxs("div",{className:"space-y-4 border-t pt-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Gallery"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files||[]);if(!t.length)return;g(null),x(!0),X({current:0,total:t.length});const r=[];let a=0;try{const e=Array.from({length:Math.min(4,t.length)},(()=>(async()=>{for(;;){const s=a++;if(s>=t.length)return;const i=t[s];try{const e=i.type.startsWith("image/")?await ne(i):i,t=await ie(e,"gallery"),a=i.name.replace(/\.[^/.]+$/,"").replace(/[-_]/g," ");r.push({id:de(),url:t,alt:a})}catch(e){g(e.message||"Failed to upload one or more files")}finally{X((e=>({current:e.current+1,total:t.length})))}}})()));await Promise.all(e),r.length&&Y((e=>[...r,...e]))}catch(s){g(s.message||"Failed to upload files")}finally{x(!1),X({current:0,total:0});try{e.target.value=""}catch{}}},disabled:h,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),h&&G.total>0&&r.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:["Uploading ",G.current," / ",G.total,"â€¦"]})]})})]}),r.jsx("div",{className:"flex gap-3 overflow-x-auto py-2",children:H.map(((e,t)=>r.jsxs("div",{className:"relative w-40 h-28 flex-shrink-0 rounded overflow-hidden shadow-md bg-gray-50 dark:bg-gray-700",children:[r.jsx("button",{type:"button",onClick:()=>(e=>{Y(H.filter(((t,r)=>r!==e)))})(t),className:"absolute top-1 right-1 z-20 bg-black/60 text-white rounded-full w-6 h-6 flex items-center justify-center","aria-label":`Remove gallery item ${t+1}`,children:"Ã—"}),e.url&&(e.url.endsWith(".mp4")||e.url.endsWith(".mov")?r.jsx("video",{src:e.url,className:"w-full h-full object-cover",controls:!0}):r.jsx("img",{src:e.url,alt:e.alt||`Gallery ${t+1}`,className:"w-full h-full object-cover"}))]},e.id||t)))})]}),r.jsx("div",{className:"border-t pt-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"checkbox",id:"featured",checked:ae,onChange:e=>se(e.target.checked),className:"w-4 h-4"}),r.jsx("label",{htmlFor:"featured",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mark as Featured Project"})]})}),r.jsxs("div",{className:"flex gap-3 pt-4 border-t sticky bottom--1 bg-white dark:bg-gray-800",children:[r.jsx(l,{type:"button",onClick:e,className:"flex-1 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-900 dark:text-white",children:"Cancel"}),r.jsx(l,{type:"submit",disabled:o,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:o?"Saving...":a?"Update Project":"Create Project"})]})]})]})})},he=()=>{const{user:a,signOut:s}=e(),o=i(),[d,c]=n.useState([]),[m,g]=n.useState(!0),[u,p]=n.useState(!1),[y,b]=n.useState(void 0),[f,v]=n.useState(null);n.useEffect((()=>{w()}),[]);const w=async()=>{try{g(!0);const[{data:e},{data:r,error:a},{data:s}]=await Promise.all([t.from("project_types").select("*"),t.from("projects").select("*").eq("is_active",!0).order("created_at",{ascending:!1}),t.from("project_gallery").select("*")]);if(a)throw a;const i={};(e||[]).forEach((e=>{i[e.id]=e}));const n=e=>{if(!e)return"";if(e.startsWith("http"))return e;const{data:r}=t.storage.from("project-images").getPublicUrl(e);return(null==r?void 0:r.publicUrl)||e},o=(r||[]).map((e=>{var t,r;return{...e,type_key:null==(t=i[e.type_id])?void 0:t.type_key,type_description:null==(r=i[e.type_id])?void 0:r.description,featured_image_url:n(e.featured_image_url||""),gallery:(s||[]).filter((t=>t.project_id===e.id)).map((e=>({...e,url:n(e.url)})))}}));c(o||[])}catch(e){}finally{g(!1)}},j=()=>{p(!1),b(void 0),w()},k=d.map(((e,t)=>{var a,s;const i=e.featured_image_url||(null==(s=null==(a=e.gallery)?void 0:a[0])?void 0:s.url)||"",n=r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"rounded-lg overflow-hidden",children:i?r.jsx("img",{src:i,alt:e.image_alt||e.title,className:"w-full h-40 object-cover"}):r.jsx("div",{className:"w-full h-40 bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-sm text-gray-500",children:"No main image"})}),r.jsx("p",{className:"text-base text-neutral-600 dark:text-neutral-400",children:e.long_description||e.description}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Client"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:e.client})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Duration"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:e.duration})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-1",children:"Year"}),r.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:e.year})]})]}),e.gallery&&e.gallery.length>0&&r.jsxs("div",{className:"mt-6",children:[r.jsx("h4",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:"Gallery"}),r.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-thin scrollbar-thumb-neutral-400 scrollbar-track-neutral-200 dark:scrollbar-thumb-neutral-600 dark:scrollbar-track-neutral-800",children:e.gallery.map(((e,t)=>r.jsx("div",{className:"flex-shrink-0 w-64 snap-center",children:r.jsx("div",{className:"rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:e.url.endsWith(".mp4")?r.jsx("video",{src:e.url,controls:!0,className:"w-full h-48 object-cover"}):r.jsx("img",{src:e.url,alt:e.alt,className:"w-full h-48 object-cover hover:scale-105 transition-transform duration-300"})})},t)))})]})]});return r.jsx(h,{index:t,layout:!0,compact:!0,card:{src:i,title:e.title,category:e.type_description||"â€”",content:n}},e.id)}));return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("button",{onClick:()=>o("/admin/dashboard"),className:"text-blue-600 dark:text-blue-400 hover:underline mb-2 text-sm",children:"â† Back to Dashboard"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Projects"}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:null==a?void 0:a.email})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(l,{onClick:()=>p(!0),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"+ Add New Project"}),r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})]})]})})}),r.jsxs("main",{className:"h-[calc(100vh-120px)] flex gap-4 px-4 sm:px-6 lg:px-8 py-4",children:[r.jsxs("div",{className:"w-1/2 overflow-y-auto",children:[r.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Your Projects (",d.length,")"]}),r.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 block",children:"Select a project to edit its details or delete it."}),m?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):r.jsx(r.Fragment,{children:0===d.length?r.jsx("div",{className:"text-center py-12 text-gray-500",children:'No projects yet. Click "Add New Project" to get started.'}):r.jsx("div",{className:"space-y-4",children:d.map((e=>r.jsxs("div",{onClick:()=>(e=>{b(e),p(!0)})(e),className:"relative group rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-shadow bg-white dark:bg-gray-800 p-4 cursor-pointer",children:[r.jsx("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{v({id:e,title:t})})(e.id,e.title)},className:"absolute top-2 right-2 z-10 w-8 h-8 flex items-center justify-center bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg opacity-0 group-hover:opacity-100",title:"Delete project",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("div",{className:"flex gap-4",children:r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:e.title}),r.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.type_key||"â€”"," â€¢ ",e.year||""]}),r.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-2",children:e.description}),r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded",children:e.type_key||"â€”"})})]})})]},e.id)))})})]}),r.jsxs("div",{className:"w-1/2 sticky top-0",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Live Preview"}),r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border-2 border-gray-300 dark:border-gray-600 overflow-y-auto max-h-[calc(100vh-200px)]",children:0===d.length?r.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500 dark:text-gray-400",children:"No projects to preview"}):r.jsx("div",{className:"space-y-8",children:r.jsx(x,{items:k,initialScroll:0})})})]})]}),u&&r.jsx(ce,{onClose:j,project:y,onSaved:j}),f&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsx("h3",{className:"ml-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Project"})]}),r.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:['Are you sure you want to delete "',r.jsx("span",{className:"font-semibold",children:f.title}),'"? This action is ',r.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:"IRREVERSIBLE"}),"."]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(l,{onClick:()=>v(null),className:"px-4 py-2 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-900 dark:text-white",children:"Cancel"}),r.jsx(l,{onClick:async()=>{if(f)try{const{error:e}=await t.from("projects").update({is_active:!1}).eq("id",f.id);if(e)throw e;v(null),w()}catch(e){alert("Failed to delete project")}},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})})]})},xe=()=>{const{user:a,signOut:s}=e(),o=i(),[d,c]=n.useState([]),[h,x]=n.useState(!0),[m,g]=n.useState("all"),[u,p]=n.useState(null),[y,b]=n.useState("all");n.useEffect((()=>{f()}),[m,y]);const f=async()=>{try{x(!0);const e=[{name:"corporate_event_inquiries",type:"corporate_event"},{name:"team_building_inquiries",type:"team_building"},{name:"csr_inquiries",type:"csr"},{name:"training_program_inquiries",type:"training_program"}];let r=[];for(const a of e){if("all"!==m&&a.type!==m)continue;let e=t.from(a.name).select("*").order("created_at",{ascending:!1});"all"!==y&&(e=e.eq("status",y));const{data:s,error:i}=await e;i||s&&(r=[...r,...s.map((e=>({...e,type:a.type})))])}r.sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())),c(r)}catch(e){}finally{x(!1)}},v=e=>({corporate_event:"Corporate Event",team_building:"Team Building",csr:"CSR",training_program:"Training Program"}[e]);return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("button",{onClick:()=>o("/admin/dashboard"),className:"text-blue-600 dark:text-blue-400 hover:underline mb-2 text-sm",children:"â† Back to Dashboard"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Inquiries"}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:null==a?void 0:a.email})]}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})})]})})}),r.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsxs("div",{className:"mb-6 flex flex-wrap gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Inquiry Type"}),r.jsxs("select",{value:m,onChange:e=>g(e.target.value),className:"h-10 w-full min-w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm hover:border-gray-400 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 cursor-pointer appearance-none bg-[length:1.5em] bg-[right_0.5rem_center] bg-no-repeat [background-image:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22m6%208%204%204%204-4%22%2F%3E%3C%2Fsvg%3E')] pr-10 [&>option]:rounded-md [&>option]:bg-white [&>option]:dark:bg-gray-800 [&>option]:text-gray-900 [&>option]:dark:text-white [&>option]:py-2 [&>option]:px-3 [&>option]:m-1",style:{backgroundImage:"url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E\")"},children:[r.jsx("option",{value:"all",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"All Types"}),r.jsx("option",{value:"corporate_event",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Corporate Event"}),r.jsx("option",{value:"team_building",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Team Building"}),r.jsx("option",{value:"csr",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"CSR"}),r.jsx("option",{value:"training_program",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Training Program"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),r.jsxs("select",{value:y,onChange:e=>b(e.target.value),className:"h-10 w-full min-w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm hover:border-gray-400 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 cursor-pointer appearance-none bg-[length:1.5em] bg-[right_0.5rem_center] bg-no-repeat [background-image:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236b7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22m6%208%204%204%204-4%22%2F%3E%3C%2Fsvg%3E')] pr-10 [&>option]:rounded-md [&>option]:bg-white [&>option]:dark:bg-gray-800 [&>option]:text-gray-900 [&>option]:dark:text-white [&>option]:py-2 [&>option]:px-3 [&>option]:m-1",style:{backgroundImage:"url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E\")"},children:[r.jsx("option",{value:"all",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"All Status"}),r.jsx("option",{value:"pending",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Pending"}),r.jsx("option",{value:"contacted",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Contacted"}),r.jsx("option",{value:"completed",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Completed"}),r.jsx("option",{value:"cancelled",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-md",children:"Cancelled"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Inquiries"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.length})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:d.filter((e=>"pending"===e.status)).length})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Contacted"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:d.filter((e=>"contacted"===e.status)).length})]}),r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"}),r.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:d.filter((e=>"completed"===e.status)).length})]})]}),h?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):r.jsx(r.Fragment,{children:0===d.length?r.jsx("div",{className:"text-center py-12 text-gray-500",children:"No inquiries found."}):r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Company"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:d.map((e=>{return r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:r.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs",children:v(e.type)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.company_name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.contact}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${t=e.status,{pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",contacted:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",completed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:e.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.created_at).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx(l,{onClick:()=>p(e),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1",children:"View Details"})})]},e.id);var t}))})]})})})})]}),u&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Inquiry Details"}),r.jsx("button",{onClick:()=>p(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsxs("div",{className:"px-6 py-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:v(u.type)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),r.jsxs("select",{value:u.status,onChange:e=>(async(e,r)=>{try{const a=`${e.type}_inquiries`,{error:s}=await t.from(a).update({status:r,updated_at:(new Date).toISOString()}).eq("id",e.id);if(s)throw s;f(),p(null)}catch(a){alert("Failed to update inquiry status")}})(u,e.target.value),className:"w-full h-10 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm hover:border-gray-400 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 cursor-pointer appearance-none bg-[length:1.5em] bg-[right_0.5rem_center] bg-no-repeat pr-10 [&>option]:rounded-md [&>option]:bg-white [&>option]:dark:bg-gray-700 [&>option]:text-gray-900 [&>option]:dark:text-white [&>option]:py-2 [&>option]:px-3 [&>option]:m-1",style:{backgroundImage:"url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E\")"},children:[r.jsx("option",{value:"pending",className:"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md",children:"Pending"}),r.jsx("option",{value:"contacted",className:"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md",children:"Contacted"}),r.jsx("option",{value:"completed",className:"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md",children:"Completed"}),r.jsx("option",{value:"cancelled",className:"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md",children:"Cancelled"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Contact"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.contact})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company Name"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.company_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.company_email})]}),u.industry&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Industry"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.industry})]}),u.no_of_pax&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Number of Pax"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.no_of_pax})]}),u.duration&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Duration"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.duration})]}),u.estimated_event_month&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Estimated Event Month"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.estimated_event_month})]}),u.budget&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Budget"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.budget})]}),u.preferred_location&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Preferred Location"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.preferred_location})]}),u.language&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Language"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.language})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"HRDC Claimable"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:u.hrdc?"Yes":"No"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Created At"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(u.created_at).toLocaleString()})]})]}),u.remarks&&r.jsxs("div",{className:"mt-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remarks"}),r.jsx("p",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:u.remarks})]})]}),r.jsx("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900 px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"flex justify-end",children:r.jsx(l,{onClick:()=>p(null),className:"bg-gray-600 hover:bg-gray-700 text-white",children:"Close"})})})]})})]})},me=()=>{const{user:a,signOut:s}=e(),o=i(),[d,c]=n.useState([]),[h,x]=n.useState(!0),[m,g]=n.useState(null),[u,p]=n.useState("");n.useEffect((()=>{y()}),[]);const y=async()=>{try{x(!0);const{data:e,error:r}=await t.from("bookings").select("*").order("created_at",{ascending:!1});if(r)throw r;c(e||[])}catch(e){}finally{x(!1)}},b=async e=>{if(confirm("Are you sure you want to delete this booking?"))try{const{error:r}=await t.from("bookings").delete().eq("id",e);if(r)throw r;y(),g(null)}catch(r){alert("Failed to delete booking")}},f=d.filter((e=>{var t;return e.customer_name.toLowerCase().includes(u.toLowerCase())||(null==(t=e.company)?void 0:t.toLowerCase().includes(u.toLowerCase()))||e.slot_id.toLowerCase().includes(u.toLowerCase())}));return r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("button",{onClick:()=>o("/admin/dashboard"),className:"text-blue-600 dark:text-blue-400 hover:underline mb-2 text-sm",children:"â† Back to Dashboard"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Manage Bookings"}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:null==a?void 0:a.email})]}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsx(l,{onClick:async()=>{await s(),o("/")},className:"bg-red-600 hover:bg-red-700 text-white",children:"Sign Out"})})]})})}),r.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsx("div",{className:"mb-6",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[r.jsx("div",{className:"w-full md:w-96",children:r.jsx("input",{type:"text",placeholder:"Search by name, company, or slot ID...",value:u,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})}),r.jsx("div",{className:"flex gap-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Bookings"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.length})]})})]})}),h?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Loading..."})}):r.jsx(r.Fragment,{children:0===f.length?r.jsx("div",{className:"text-center py-12 text-gray-500",children:u?"No bookings found matching your search.":"No bookings yet."}):r.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Customer Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Company"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Slot ID"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Appointment Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Created At"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:f.map((e=>r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.customer_name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.company||"â€”"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:r.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded text-xs font-mono",children:e.slot_id})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.appointment_time||"â€”"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.created_at).toLocaleString()}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[r.jsx(l,{onClick:()=>g(e),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1 mr-2",children:"View"}),r.jsx(l,{onClick:()=>b(e.id),className:"bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1",children:"Delete"})]})]},e.id)))})]})})})})]}),m&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full",children:[r.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Booking Details"}),r.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsx("div",{className:"px-6 py-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Booking ID"}),r.jsx("p",{className:"text-gray-900 dark:text-white font-mono text-sm",children:m.id})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Slot ID"}),r.jsx("p",{className:"text-gray-900 dark:text-white font-mono",children:m.slot_id})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Customer Name"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:m.customer_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:m.company||"â€”"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Appointment Time"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:m.appointment_time||"â€”"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Created At"}),r.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(m.created_at).toLocaleString()})]})]})}),r.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"flex justify-between",children:[r.jsx(l,{onClick:()=>b(m.id),className:"bg-red-600 hover:bg-red-700 text-white",children:"Delete Booking"}),r.jsx(l,{onClick:()=>g(null),className:"bg-gray-600 hover:bg-gray-700 text-white",children:"Close"})]})})]})})]})},ge=({children:t})=>{const{user:a,isAdmin:s,loading:o}=e(),l=i();return n.useEffect((()=>{o||a&&s||l("/admin/login")}),[a,s,o,l]),o?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 dark:border-blue-400"}),r.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading..."})]})}):a&&s?r.jsx(r.Fragment,{children:t}):null};export{m as AdminDashboard,g as AdminLogin,u as AdminRegister,me as BookingsManager,ae as ClientLogosManager,ee as HeroImagesManager,xe as InquiriesManager,he as ProjectsManager,ge as ProtectedRoute};
